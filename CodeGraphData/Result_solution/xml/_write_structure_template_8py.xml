<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="_write_structure_template_8py" kind="file">
    <compoundname>WriteStructureTemplate.py</compoundname>
    <innernamespace refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template">Original Structures::Structures::WriteStructureTemplate</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template" refkind="compound"><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Tables<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>tb</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>StructureData<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>build_structures_lookup</highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>StructureData<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>build_structures_list</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>StructureData<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>build_structures_element</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>StructureData<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>define_structure_attributes</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>pathlib<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Path</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>pandas<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>pd</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>xml.etree.ElementTree<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>ET</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">#import<sp/>LoggingConfig<sp/>as<sp/>log</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">#logger<sp/>=<sp/>log.logging_init(__name__)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal">tb.VARIABLE_TYPES<sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;Structure&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;Template&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">#VERSION<sp/>=<sp/>10.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1aacbb1c870c4ef481efaf1b1bb9bc7377" refkind="member"><highlight class="normal">VERSION<sp/>=<sp/>13.6</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a7977165566325d19091e03f0896bcd65" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a7977165566325d19091e03f0896bcd65" kindref="member">define_template_attributes</ref>():</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;Create<sp/>a<sp/>dictionary<sp/>with<sp/>Type<sp/>Variable<sp/>values<sp/>that<sp/>define<sp/>all<sp/>of<sp/>the<sp/>template<sp/>attributes.</highlight></codeline>
<codeline lineno="20"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/>var_type<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Template&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/>is_string<sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>isinstance(x,str)</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>id_check<sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>x:<sp/>is_string(x)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>len(x)<sp/>&lt;<sp/>13</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#TODO<sp/>more<sp/>attribute<sp/>checks<sp/>should<sp/>be<sp/>added<sp/>to<sp/>the<sp/>attribute<sp/>definitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/>template_def<sp/>=<sp/>[(</highlight><highlight class="stringliteral">&apos;Version&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>1.0),<sp/>\</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Type&apos;</highlight><highlight class="normal">,<sp/>is_string,<sp/></highlight><highlight class="stringliteral">&apos;Structure&apos;</highlight><highlight class="normal">),<sp/>\</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;ID&apos;</highlight><highlight class="normal">,<sp/>id_check,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">),<sp/>\</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Diagnosis&apos;</highlight><highlight class="normal">,<sp/>is_string,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">),<sp/>\</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;TreatmentSite&apos;</highlight><highlight class="normal">,<sp/>is_string,<sp/></highlight><highlight class="stringliteral">&apos;.All&apos;</highlight><highlight class="normal">),<sp/>\</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;AssignedUsersID&apos;</highlight><highlight class="normal">,<sp/>is_string,<sp/></highlight><highlight class="stringliteral">&apos;gsal;&apos;</highlight><highlight class="normal">),<sp/>\</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Description&apos;</highlight><highlight class="normal">,<sp/>is_string,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">),<sp/>\</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;ApprovalStatus&apos;</highlight><highlight class="normal">,<sp/>is_string,<sp/></highlight><highlight class="stringliteral">&apos;Unapproved&apos;</highlight><highlight class="normal">),<sp/>\</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;ApprovalHistory&apos;</highlight><highlight class="normal">,<sp/>is_string,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">),<sp/>\</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;LastModified&apos;</highlight><highlight class="normal">,<sp/>is_string,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/>{ID:<sp/>tb.Variable(ID,<sp/>var_type,<sp/>validate=val,<sp/>default=dflt)</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(ID,<sp/>val,<sp/>dflt)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>template_def}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a120d29f93f28c262d43c856c2077434b" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a120d29f93f28c262d43c856c2077434b" kindref="member">define_template_tables</ref>(file_path:<sp/>Path,<sp/>sheet_name:<sp/>str,<sp/>\</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmpl_title:<sp/>str,<sp/>tmpl_offset=</highlight><highlight class="stringliteral">&apos;A1&apos;</highlight><highlight class="normal">,<sp/>tmpl_columns=2,<sp/>\</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>struc_title=</highlight><highlight class="stringliteral">&apos;Template<sp/>Structures&apos;</highlight><highlight class="normal">,<sp/>struc_offset=</highlight><highlight class="stringliteral">&apos;D1&apos;</highlight><highlight class="normal">,<sp/>struc_columns=5):</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;Create<sp/>Table<sp/>definitions<sp/>for<sp/>the<sp/>template<sp/>table<sp/>and</highlight></codeline>
<codeline lineno="43"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>it&apos;s<sp/>companion<sp/>structure<sp/>list<sp/>required<sp/>to<sp/>build<sp/>a<sp/>structure<sp/>template.</highlight></codeline>
<codeline lineno="44"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#TODO<sp/>define_template_tables<sp/>is<sp/>getting<sp/>messy<sp/>probably<sp/>should<sp/>get<sp/>rid<sp/>of<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>values<sp/>for<sp/>all<sp/>tables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/>tmp_index<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Attribute&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>str_index<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;ID&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Rows<sp/>is<sp/>not<sp/>yet<sp/>implemented<sp/>not<sp/>using</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/>template_table<sp/>=<sp/>tb.Table(file_path,<sp/>sheet_name,<sp/>tmpl_title,<sp/>tmp_index,<sp/>tmpl_offset,<sp/>columns=tmpl_columns)</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/>structures_dfn<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_structure_data_1a6ed1bbb88ef069417b70f6e0d0b799e7" kindref="member">define_structure_attributes</ref>()</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/>structures_table<sp/>=<sp/>tb.Table(file_path,<sp/>sheet_name,<sp/>struc_title,<sp/>str_index,<sp/>struc_offset,<sp/>struc_columns,<sp/>variables=structures_dfn)</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/>(template_table,<sp/>structures_table)</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a22d1c12bd349a0d6858c6b39ad16749f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a22d1c12bd349a0d6858c6b39ad16749f" kindref="member">build_template_data</ref>(template_table:<sp/>tb.Table):</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;Create<sp/>a<sp/>dictionary<sp/>of<sp/>template<sp/>data<sp/>from<sp/>template_table<sp/>and<sp/>the<sp/>default<sp/>template_attributes.</highlight></codeline>
<codeline lineno="58"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/>template_attributes<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a7977165566325d19091e03f0896bcd65" kindref="member">define_template_attributes</ref>()</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>template_data<sp/>=<sp/>template_table.read_table()</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Transpose<sp/>table<sp/>so<sp/>that<sp/>each<sp/>attribute<sp/>becomes<sp/>a<sp/>column</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/>template_data<sp/>=<sp/>template_data.T.reset_index(drop=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#TODO<sp/>Select<sp/>and<sp/>validate<sp/>attributes<sp/>in<sp/>this<sp/>table</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/>template_data<sp/>=<sp/>tb.insert_defaults(template_data,<sp/>template_attributes)</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/>template_data<sp/>=<sp/>tb.insert_missing_variables(template_data,<sp/>template_attributes)</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#Only<sp/>one<sp/>template<sp/>definition<sp/>per<sp/>table,<sp/>so<sp/>select<sp/>the<sp/>first<sp/>row<sp/>from<sp/>the<sp/>DataFrame</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dict(template_data.iloc[0,:])</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a1889adee530e00f92abd6d8143971e1f" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a1889adee530e00f92abd6d8143971e1f" kindref="member">list_of_structures</ref>(structures,<sp/>begin_text=None,<sp/>sort_IDs=True):</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;Assemble<sp/>a<sp/>text<sp/>string<sp/>that<sp/>includes<sp/>the<sp/>begin_text<sp/>(or<sp/>default)<sp/>and<sp/>a</highlight></codeline>
<codeline lineno="71"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>comma<sp/>separated<sp/>list<sp/>of<sp/>all<sp/>structure<sp/>IDs<sp/>in<sp/>the<sp/>structures<sp/>DataFrame</highlight></codeline>
<codeline lineno="72"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>structures<sp/>are<sp/>sorted<sp/>alphabetically<sp/>by<sp/>default.</highlight></codeline>
<codeline lineno="73"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/>default_text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;\u000aStructures<sp/>Included:<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>begin_text<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>begin_text<sp/>=<sp/>default_text</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>structure_IDs<sp/>=<sp/>list(structures[</highlight><highlight class="stringliteral">&apos;ID&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>sort_IDs:</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>structure_IDs.sort()</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/>struct_list<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&apos;</highlight><highlight class="normal">.join(structure_IDs)</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/>struct_summary<sp/>=<sp/>begin_text<sp/>+<sp/>struct_list</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>struct_summary</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight></codeline>
<codeline lineno="84" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a8b31e7c8b77b0d095a15fcb2fa405b30" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a8b31e7c8b77b0d095a15fcb2fa405b30" kindref="member">add_preview</ref>(template,<sp/>template_data):</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;Add<sp/>a<sp/>the<sp/>preview<sp/>element<sp/>to<sp/>the<sp/>template<sp/>tree<sp/>using<sp/>the<sp/>data<sp/>in<sp/>template_data.</highlight></codeline>
<codeline lineno="86"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/>type<sp/>=<sp/>tb.get_value(template_data,<sp/></highlight><highlight class="stringliteral">&apos;Type&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/>site<sp/>=<sp/>tb.get_value(template_data,<sp/></highlight><highlight class="stringliteral">&apos;TreatmentSite&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>diagnosis<sp/>=<sp/>tb.get_value(template_data,<sp/></highlight><highlight class="stringliteral">&apos;Diagnosis&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/>description<sp/>=<sp/>tb.get_value(template_data,<sp/></highlight><highlight class="stringliteral">&apos;Description&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>users<sp/>=<sp/>tb.get_value(template_data,<sp/></highlight><highlight class="stringliteral">&apos;AssignedUsers&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/>tb.get_value(template_data,<sp/></highlight><highlight class="stringliteral">&apos;ApprovalStatus&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/>history<sp/>=<sp/>tb.get_value(template_data,<sp/></highlight><highlight class="stringliteral">&apos;ApprovalHistory&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/>modified<sp/>=<sp/>tb.get_value(template_data,<sp/></highlight><highlight class="stringliteral">&apos;LastModified&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>preview<sp/>=<sp/>ET.SubElement(template,<sp/></highlight><highlight class="stringliteral">&apos;Preview<sp/>&apos;</highlight><highlight class="normal">,<sp/>\</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;ID&apos;</highlight><highlight class="normal">:template_data[</highlight><highlight class="stringliteral">&apos;ID&apos;</highlight><highlight class="normal">],<sp/>\</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Type&apos;</highlight><highlight class="normal">:type,<sp/>\</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;TreatmentSite&apos;</highlight><highlight class="normal">:site,<sp/>\</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Diagnosis&apos;</highlight><highlight class="normal">:diagnosis,<sp/>\</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Description&apos;</highlight><highlight class="normal">:description,<sp/>\</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;AssignedUsers&apos;</highlight><highlight class="normal">:users,<sp/>\</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ApprovalStatus&apos;</highlight><highlight class="normal">:status,<sp/>\</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ApprovalHistory&apos;</highlight><highlight class="normal">:history,<sp/>\</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;LastModified&apos;</highlight><highlight class="normal">:modified})</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>preview</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1ad19cda83df3f1bf8eb701417954e06a9" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1ad19cda83df3f1bf8eb701417954e06a9" kindref="member">make_template</ref>(template_data,<sp/>structures,<sp/>template_file:<sp/>Path):</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;Create<sp/>a<sp/>template<sp/>XML<sp/>from<sp/>template<sp/>and<sp/>structure<sp/>data.</highlight></codeline>
<codeline lineno="111"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>ET.register_namespace(</highlight><highlight class="stringliteral">&apos;xsi&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/XMLSchema-instance&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>VERSION<sp/>==<sp/>13.6:</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>template<sp/>=<sp/>ET.Element(</highlight><highlight class="stringliteral">&apos;StructureTemplate&apos;</highlight><highlight class="normal">,attrib={</highlight><highlight class="stringliteral">&apos;Version&apos;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&apos;1.1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:xsi&apos;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>VERSION<sp/>==<sp/>10.0:</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>template<sp/>=<sp/>ET.Element(</highlight><highlight class="stringliteral">&apos;StructureTemplate&apos;</highlight><highlight class="normal">,attrib={</highlight><highlight class="stringliteral">&apos;Version&apos;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&apos;1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:xsi&apos;</highlight><highlight class="normal">:</highlight><highlight class="stringliteral">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;{}<sp/>is<sp/>an<sp/>invalid<sp/>version.&apos;</highlight><highlight class="normal">.format(VERSION))</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a8b31e7c8b77b0d095a15fcb2fa405b30" kindref="member">add_preview</ref>(template,<sp/>template_data)</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>structure_set<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_structure_data_1a434014ae4e19e2b44a81f097039347fe" kindref="member">build_structures_element</ref>(structures,<sp/>VERSION)</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>template.append(structure_set)</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/>template_tree<sp/>=<sp/>ET.ElementTree(template)</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>template_tree.write(str(template_file),<sp/>encoding=</highlight><highlight class="stringliteral">&apos;UTF-8&apos;</highlight><highlight class="normal">,<sp/>xml_declaration=</highlight><highlight class="keyword">True</highlight><highlight class="normal">,<sp/>short_empty_elements=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a0bac5fcda87e855b54013eb012fdac4a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a0bac5fcda87e855b54013eb012fdac4a" kindref="member">build_templates</ref>(template_list,<sp/>base_path,<sp/>structures_lookup,<sp/>include_structure_list=False):</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&apos;&apos;Build<sp/>a<sp/>collection<sp/>of<sp/>structure<sp/>template<sp/>files<sp/>from<sp/>the<sp/>list<sp/>of<sp/>templates</highlight></codeline>
<codeline lineno="131"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>in<sp/>template_list<sp/>that<sp/>describe<sp/>template<sp/>data<sp/>in<sp/>the<sp/>template<sp/>file.<sp/>Structure</highlight></codeline>
<codeline lineno="132"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>data<sp/>used<sp/>for<sp/>the<sp/>templates<sp/>comes<sp/>from<sp/>the<sp/>structures_lookup<sp/>data-frame.</highlight></codeline>
<codeline lineno="133"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&apos;&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/>all_structure_data<sp/>=<sp/>pd.DataFrame()</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>tmpl<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/><sp/>template_list:</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&apos;Building<sp/>Template:<sp/>%s&apos;</highlight><highlight class="normal"><sp/>%tmpl[</highlight><highlight class="stringliteral">&apos;title&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>template_file_path<sp/>=<sp/>base_path<sp/>/<sp/>tmpl[</highlight><highlight class="stringliteral">&apos;workbook_name&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(template_table,<sp/>structures_table)<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a120d29f93f28c262d43c856c2077434b" kindref="member">define_template_tables</ref>(template_file_path,<sp/>\</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sheet_name=tmpl[</highlight><highlight class="stringliteral">&apos;sheet_name&apos;</highlight><highlight class="normal">],<sp/>\</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tmpl_title=<sp/>tmpl[</highlight><highlight class="stringliteral">&apos;title&apos;</highlight><highlight class="normal">],<sp/>\</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>struc_columns=tmpl[</highlight><highlight class="stringliteral">&apos;columns&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#Load<sp/>the<sp/>template<sp/>and<sp/>structure<sp/>data<sp/>from<sp/>the<sp/>excel<sp/>worksheet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>template_data<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a22d1c12bd349a0d6858c6b39ad16749f" kindref="member">build_template_data</ref>(template_table)</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>structures<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_structure_data_1a6a27cb21ca55402530f8f21d0601499b" kindref="member">build_structures_list</ref>(structures_table,<sp/>structures_lookup)</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#Create<sp/>and<sp/>return<sp/>a<sp/>summary<sp/>of<sp/>the<sp/>template<sp/>structures</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>structure_data<sp/>=<sp/>structures</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>structure_data[</highlight><highlight class="stringliteral">&apos;Template&apos;</highlight><highlight class="normal">]<sp/>=<sp/>template_data[</highlight><highlight class="stringliteral">&apos;ID&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>structure_data[</highlight><highlight class="stringliteral">&apos;TreatmentSite&apos;</highlight><highlight class="normal">]<sp/>=<sp/>template_data[</highlight><highlight class="stringliteral">&apos;TreatmentSite&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>structure_data[</highlight><highlight class="stringliteral">&apos;TemplateType&apos;</highlight><highlight class="normal">]<sp/>=<sp/>template_data[</highlight><highlight class="stringliteral">&apos;Type&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>structure_data[</highlight><highlight class="stringliteral">&apos;TemplateDescription&apos;</highlight><highlight class="normal">]<sp/>=<sp/>template_data[</highlight><highlight class="stringliteral">&apos;Description&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>include_structure_list:</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#Add<sp/>list<sp/>of<sp/>structures<sp/>to<sp/>the<sp/>template<sp/>description</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>struct_summary<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a1889adee530e00f92abd6d8143971e1f" kindref="member">list_of_structures</ref>(structures)</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>description<sp/>=<sp/>template_data[</highlight><highlight class="stringliteral">&apos;Description&apos;</highlight><highlight class="normal">]<sp/>+<sp/>struct_summary</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>template_data[</highlight><highlight class="stringliteral">&apos;Description&apos;</highlight><highlight class="normal">]<sp/>=<sp/>description</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>the<sp/>template<sp/>and<sp/>structure<sp/>data<sp/>to<sp/>an<sp/>XML<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>template_save_file<sp/>=<sp/>base_path<sp/>/<sp/>tmpl[</highlight><highlight class="stringliteral">&apos;output_file_name&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>template_tree<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1ad19cda83df3f1bf8eb701417954e06a9" kindref="member">make_template</ref>(template_data,<sp/>structures,<sp/>template_save_file)</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>all_structure_data<sp/>=<sp/>all_structure_data.append(structure_data,<sp/>ignore_index=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>all_structure_data</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;__main__&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#base_path<sp/>=<sp/>Path(r&apos;C:\Users\gsalomon\OneDrive<sp/>for<sp/>Business<sp/>1\Structure<sp/>Dictionary&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a6ad8a48cf2e7955411ed56616d757c5b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>base_path<sp/>=<sp/>Path(</highlight><highlight class="stringliteral">r&apos;C:\Users\gsalomon\OneDrive<sp/>for<sp/>Business<sp/>1\Structure<sp/>Dictionary\Templates\New<sp/>Templates\V13&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#base_path<sp/>=<sp/>Path(r&quot;C:\Users\Greg\OneDrive<sp/>-<sp/>Queen&apos;s<sp/>University\Structure<sp/>Dictionary&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/>base_path<sp/>=<sp/>Path(</highlight><highlight class="stringliteral">r&quot;C:\Users\Greg\OneDrive<sp/>-<sp/>Queen&apos;s<sp/>University\Structure<sp/>Dictionary\Templates\New<sp/>Templates\V13&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="167" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a5c907404348a13dfe520c84ee1c4cacd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>structures_lookup_file_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Structure<sp/>Lookup.xlsx&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1aaf0887db09796618fb3e669e3197a847" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>structures_file_path<sp/>=<sp/>base_path<sp/>/<sp/>structures_lookup_file_name</highlight></codeline>
<codeline lineno="169" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a215f7884765c802bd551149abc37d566" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>structures_lookup<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_structure_data_1aec3f6fbecdae2ca68bc6e3a4bf2bb452" kindref="member">build_structures_lookup</ref>(structures_file_path)</highlight></codeline>
<codeline lineno="170" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1af94fbc199a7baa8040ddf503fa141946" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>templates_list<sp/>=<sp/>[<sp/>\</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;workbook_name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Specialty<sp/>Templates.xlsx&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;sheet_name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Artifact&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;title&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Artifact&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;file_name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Artifact.xml&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;columns&apos;</highlight><highlight class="normal">:<sp/>5},<sp/>\</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;workbook_name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Basic<sp/>Templates.xlsx&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;sheet_name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;CT&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;title&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;CT&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;file_name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;CT<sp/>Template.xml&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;columns&apos;</highlight><highlight class="normal">:<sp/>3}]</highlight></codeline>
<codeline lineno="173" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1acac8a3f60f86494a01845da328fe6161" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>structure_data<sp/>=<sp/><ref refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1a0bac5fcda87e855b54013eb012fdac4a" kindref="member">build_templates</ref>(templates_list,<sp/>base_path,<sp/>structures_lookup,<sp/>include_structure_list=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="174" refid="namespace_original_01_structures_1_1_structures_1_1_write_structure_template_1ab9fabedf788bdb068fe2c96118532f93" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>structures_file_name<sp/>=<sp/>base_path<sp/>/<sp/></highlight><highlight class="stringliteral">&apos;Structure<sp/>data.txt&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>structure_data.to_csv(str(structures_file_name),<sp/>sep=</highlight><highlight class="stringliteral">&apos;;&apos;</highlight><highlight class="normal">,<sp/>index=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
    </programlisting>
    <location file="C:/Users/Greg/OneDrive - Queen's University/Work/Structure Dictionary/Python code/Original Structures/Structures/WriteStructureTemplate.py"/>
  </compounddef>
</doxygen>
